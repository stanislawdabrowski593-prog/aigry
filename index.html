<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <title>AIGRY v5.0</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <style>
        :root { --accent: #00d2ff; --bg: #0a0a0a; }
        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); color: #fff; margin: 0; display: flex; flex-direction: column; align-items: center; overflow-x: hidden; }
        header { background: #111; width: 100%; padding: 15px; border-bottom: 3px solid var(--accent); display: flex; justify-content: space-around; align-items: center; box-shadow: 0 5px 20px rgba(0,0,0,0.5); }
        .main-menu { display: flex; gap: 12px; margin: 20px; flex-wrap: wrap; justify-content: center; }
        .btn { background: #1a1a1a; color: #fff; border: 2px solid #333; padding: 12px 25px; cursor: pointer; border-radius: 8px; font-weight: bold; transition: 0.3s; text-transform: uppercase; letter-spacing: 1px; }
        .btn:hover { border-color: var(--accent); background: #222; transform: translateY(-3px); box-shadow: 0 5px 15px rgba(0,210,255,0.3); }
        #game-viewport { position: relative; width: 900px; height: 500px; background: #000; border: 4px solid #1a1a1a; border-radius: 15px; overflow: hidden; box-shadow: 0 0 40px rgba(0,0,0,0.8); }
        #game-viewport:fullscreen { width: 100vw; height: 100vh; border-radius: 0; border: none; }
        #hud { position: absolute; top: 20px; left: 20px; z-index: 10; font-family: 'Courier New', monospace; font-size: 20px; text-shadow: 2px 2px #000; color: var(--accent); pointer-events: none; }
        #crosshair { position: absolute; top: 50%; left: 50%; transform: translate(-50%,-50%); color: #fff; display: none; font-size: 24px; z-index: 5; pointer-events: none; opacity: 0.7; }
        .inventory { position: absolute; bottom: 10px; left: 50%; transform: translateX(-50%); display: none; gap: 5px; background: rgba(0,0,0,0.6); padding: 5px; border-radius: 5px; }
        .slot { width: 35px; height: 35px; border: 2px solid #555; }
        .slot.active { border-color: gold; box-shadow: 0 0 10px gold; }
    </style>
</head>
<body oncontextmenu="return false;">

<header>
    <div style="font-size: 28px; font-weight: 900; letter-spacing: 2px;">AIGRY <span style="color:var(--accent)">v5.0</span></div>
    <div>
        <button class="btn" style="padding: 5px 10px;" onclick="setL('pl')">PL</button>
        <button class="btn" style="padding: 5px 10px;" onclick="setL('en')">EN</button>
    </div>
</header>

<div class="main-menu">
    <button class="btn" onclick="launch('mario')">MARIO</button>
    <button class="btn" onclick="launch('mc')">MINECRAFT</button>
    <button class="btn" onclick="launch('snake')">SNAKE</button>
    <button class="btn" onclick="launch('tetris')">TETRIS</button>
</div>

<div id="game-viewport">
    <div id="hud"></div>
    <div id="crosshair">+</div>
    <div id="scene-container" style="width:100%; height:100%;"></div>
    <div id="inv" class="inventory"></div>
</div>

<button class="btn" style="margin: 20px; background: var(--accent); color: #000;" onclick="toggleFS()">PEŁNY EKRAN (F)</button>

<script>
    let loop, keys = {}, level = 1, lang = 'pl', active = '', score = 0;
    const view = document.getElementById('game-viewport');
    const hud = document.getElementById('hud');

    window.onkeydown = e => { keys[e.code] = true; if(e.code === 'KeyF') toggleFS(); };
    window.onkeyup = e => keys[e.code] = false;

    function toggleFS() {
        if (!document.fullscreenElement) view.requestFullscreen();
        else document.exitFullscreen();
    }

    function setL(l) { lang = l; if(active) launch(active); }

    function launch(game) {
        active = game;
        if(loop) cancelAnimationFrame(loop);
        document.getElementById('scene-container').innerHTML = "";
        document.getElementById('crosshair').style.display = (game === 'mc') ? "block" : "none";
        document.getElementById('inv').style.display = (game === 'mc') ? "flex" : "none";
        hud.innerText = "";
        if(game === 'mario') runMario();
        if(game === 'mc') runMC();
        if(game === 'snake') runSnake();
        if(game === 'tetris') runTetris();
    }

    // --- SUPER MARIO 5.0 (50 LEVELS) ---
    function runMario() {
        const stage = document.getElementById('scene-container');
        stage.innerHTML = '<canvas id="mc" width="900" height="500"></canvas>';
        const cvs = document.getElementById('mc'), ctx = cvs.getContext('2d');
        let p = {x:60, y:300, w:30, h:45, vx:0, vy:0, j:false};
        let goal = 2500 + (level * 200), camX = 0, coins = 0;
        let clouds = Array.from({length: 10}, () => ({x: Math.random()*goal, y: Math.random()*200, s: Math.random()*0.5+0.2}));

        function mLoop() {
            if(keys['ArrowRight'] || keys['KeyD']) p.vx = 6; else if(keys['ArrowLeft'] || keys['KeyA']) p.vx = -6; else p.vx *= 0.8;
            if((keys['Space'] || keys['ArrowUp'] || keys['KeyW']) && !p.j) { p.vy = -16; p.j = true; }
            p.vy += 0.8; p.x += p.vx; p.y += p.vy;
            if(p.y > 400) { p.y = 400; p.vy = 0; p.j = false; }
            if(p.x > 400) camX = p.x - 400;

            // Grafika
            ctx.fillStyle = "#3498db"; ctx.fillRect(0,0,900,500); // Sky
            ctx.save(); ctx.translate(-camX, 0);
            
            // Paralaksa chmur
            ctx.fillStyle = "rgba(255,255,255,0.5)";
            clouds.forEach(c => { ctx.fillRect(c.x - camX * c.s, c.y, 60, 30); });

            ctx.fillStyle = "#27ae60"; ctx.fillRect(0, 445, goal+1000, 60); // Ground
            ctx.fillStyle = "#f1c40f"; ctx.fillRect(goal, 150, 15, 300); // Flagpole
            
            // Mario
            ctx.fillStyle = "#e74c3c"; ctx.fillRect(p.x, p.y, p.w, p.h); 
            ctx.fillStyle = "#000"; ctx.fillRect(p.x+20, p.y+10, 5, 5); // Eye

            ctx.restore();
            hud.innerText = `LEVEL: ${level}/50  COINS: ${coins}`;
            if(p.x > goal) { level++; launch('mario'); }
            loop = requestAnimationFrame(mLoop);
        } mLoop();
    }

    // --- MINECRAFT 5.0 ---
    function runMC() {
        const scene = new THREE.Scene(); scene.background = new THREE.Color(0x87CEEB);
        scene.fog = new THREE.Fog(0x87CEEB, 5, 30);
        const cam = new THREE.PerspectiveCamera(75, 900/500, 0.1, 1000);
        const rend = new THREE.WebGLRenderer({antialias: true});
        rend.setSize(900, 500); document.getElementById('scene-container').appendChild(rend.domElement);
        
        const cols = [0x2ecc71, 0x7f8c8d, 0x8b4513, 0x2980b9, 0xd35400, 0xecf0f1, 0x1abc9c, 0xf1c40f, 0x2c3e50, 0x95a5a6];
        let bid = 0, blocks = [];
        
        const inv = document.getElementById('inv'); inv.innerHTML = "";
        cols.forEach((c, i) => { 
            let s = document.createElement('div'); s.className = 'slot'; 
            s.style.background = "#"+c.toString(16); if(i===0) s.classList.add('active');
            inv.appendChild(s);
        });

        for(let x=-10; x<10; x++) for(let z=-10; z<10; z++) {
            const b = new THREE.Mesh(new THREE.BoxGeometry(1,1,1), new THREE.MeshLambertMaterial({color: cols[0]}));
            b.position.set(x, 0, z); scene.add(b); blocks.push(b);
        }

        scene.add(new THREE.AmbientLight(0xffffff, 0.7));
        const l = new THREE.PointLight(0xffffff, 0.5); l.position.set(10,20,10); scene.add(l);
        cam.position.set(0, 2, 5);
        rend.domElement.onclick = () => rend.domElement.requestPointerLock();
        
        let y=0, p=0;
        document.addEventListener('mousemove', e => {
            if(document.pointerLockElement === rend.domElement) {
                y -= e.movementX*0.002; p -= e.movementY*0.002; p = Math.max(-1.5, Math.min(1.5, p));
            }
        });

        rend.domElement.onmousedown = e => {
            if(document.pointerLockElement !== rend.domElement) return;
            const dir = new THREE.Vector3(0,0,-1).applyQuaternion(cam.quaternion);
            const pos = new THREE.Vector3().copy(cam.position).add(dir.multiplyScalar(4)).round();
            if(e.button === 0) {
                const b = new THREE.Mesh(new THREE.BoxGeometry(1,1,1), new THREE.MeshLambertMaterial({color: cols[bid]}));
                b.position.copy(pos); scene.add(b); blocks.push(b);
            } else {
                blocks.forEach((b, i) => { if(b.position.distanceTo(pos) < 0.8) { scene.remove(b); blocks.splice(i, 1); }});
            }
        };

        function mcL() {
            if(keys['KeyW']) cam.translateZ(-0.12); if(keys['KeyS']) cam.translateZ(0.12);
            if(keys['KeyA']) cam.translateX(-0.12); if(keys['KeyD']) cam.translateX(0.12);
            for(let i=0; i<10; i++) if(keys['Digit'+(i+1)%10]) { 
                bid = i; Array.from(inv.children).forEach((s,idx)=>s.classList.toggle('active', idx===i)); 
            }
            cam.rotation.set(p,y,0,'YXZ');
            rend.render(scene, cam);
            hud.innerText = "MINECRAFT v5.0";
            loop = requestAnimationFrame(mcL);
        } mcL();
    }

    // --- SNAKE 5.0 (NAPRAWIONY) ---
    function runSnake() {
        const st = document.getElementById('scene-container');
        st.innerHTML = '<canvas id="sc" width="900" height="500"></canvas>';
        const cvs = document.getElementById('sc'), ctx = cvs.getContext('2d');
        let s = [{x:200, y:200}], f = {x:400, y:200}, d = 'R', nextD = 'R', lastT = 0; pts = 0;

        function sL(t) {
            if(t - lastT > 80) {
                lastT = t; d = nextD; let h = {...s[0]};
                if(keys['ArrowUp'] && d !== 'D') nextD = 'U'; if(keys['ArrowDown'] && d !== 'U') nextD = 'D';
                if(keys['ArrowLeft'] && d !== 'R') nextD = 'L'; if(keys['ArrowRight'] && d !== 'L') nextD = 'R';
                if(d === 'U') h.y -= 20; if(d === 'D') h.y += 20; if(d === 'L') h.x -= 20; if(d === 'R') h.x += 20;
                if(h.x === f.x && h.y === f.y) { pts++; f = {x: Math.floor(Math.random()*44)*20, y: Math.floor(Math.random()*24)*20}; } else s.pop();
                if(h.x < 0 || h.x >= 900 || h.y < 0 || h.y >= 500 || s.some(b=>b.x===h.x && b.y===h.y)) return launch('snake');
                s.unshift(h);
                ctx.fillStyle = "#000"; ctx.fillRect(0,0,900,500);
                ctx.fillStyle = "#00d2ff"; s.forEach(p => ctx.fillRect(p.x, p.y, 18, 18));
                ctx.fillStyle = "#ff4757"; ctx.fillRect(f.x, f.y, 18, 18);
                hud.innerText = "SCORE: " + pts;
            }
            loop = requestAnimationFrame(sL);
        } loop = requestAnimationFrame(sL);
    }

    // --- TETRIS (NOWA GRA) ---
    function runTetris() {
        const st = document.getElementById('scene-container');
        st.innerHTML = '<canvas id="tc" width="900" height="500"></canvas>';
        const cvs = document.getElementById('tc'), ctx = cvs.getContext('2d');
        ctx.fillStyle = "#111"; ctx.fillRect(0,0,900,500);
        hud.innerText = "TETRIS - WKRÓTCE PEŁNA AKTUALIZACJA";
    }

</script>
</body>
</html>
